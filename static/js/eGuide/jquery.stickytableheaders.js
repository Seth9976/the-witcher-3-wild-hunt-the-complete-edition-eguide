;(function($,window,undefined){'use strict';var name='stickyTableHeaders',id=0,defaults={fixedOffset:0,leftOffset:0,scrollableArea:window};function Plugin(el,options){var base=this;base.$el=$(el);base.el=el;base.id=id++;base.$el.bind('destroyed',$.proxy(base.teardown,base));base.$clonedHeader=null;base.$originalHeader=null;base.isSticky=false;base.hasBeenSticky=false;base.leftOffset=null;base.topOffset=null;base.init=function(){base.options=$.extend({},defaults,options);base.$el.each(function(){var $this=$(this);$this.css('padding',0);base.$scrollableArea=$(base.options.scrollableArea);base.$originalHeader=$('thead:first',this);base.$clonedHeader=base.$originalHeader.clone();$this.trigger('clonedHeader.'+ name,[base.$clonedHeader]);base.$clonedHeader.addClass('tableFloatingHeader');base.$clonedHeader.css('display','none');base.$originalHeader.addClass('tableFloatingHeaderOriginal');base.$originalHeader.after(base.$clonedHeader);base.$printStyle=$('<style type="text/css" media="print">'+'.tableFloatingHeader{display:none !important;}'+'.tableFloatingHeaderOriginal{position:static !important;}'+'</style>');$('head').append(base.$printStyle);});base.updateWidth();base.toggleHeaders();base.bind();};base.destroy=function(){base.$el.unbind('destroyed',base.teardown);base.teardown();};base.teardown=function(){if(base.isSticky){base.$originalHeader.css('position','static');}
$.removeData(base.el,'plugin_'+ name);base.unbind();base.$clonedHeader.remove();base.$originalHeader.removeClass('tableFloatingHeaderOriginal');base.$originalHeader.css('visibility','visible');base.$printStyle.remove();base.el=null;base.$el=null;};base.bind=function(){base.$scrollableArea.on('scroll.'+ name,base.toggleHeaders);if(!base.isWindowScrolling()){$(window).on('scroll.'+ name+ base.id,base.setPositionValues);$(window).on('resize.'+ name+ base.id,base.toggleHeaders);}
base.$scrollableArea.on('resize.'+ name,base.toggleHeaders);base.$scrollableArea.on('resize.'+ name,base.updateWidth);};base.unbind=function(){base.$scrollableArea.off('.'+ name,base.toggleHeaders);if(!base.isWindowScrolling()){$(window).off('.'+ name+ base.id,base.setPositionValues);$(window).off('.'+ name+ base.id,base.toggleHeaders);}
base.$scrollableArea.off('.'+ name,base.updateWidth);base.$el.off('.'+ name);base.$el.find('*').off('.'+ name);};base.toggleHeaders=function(){if(base.$el){base.$el.each(function(){var $this=$(this),newLeft,newTopOffset=base.isWindowScrolling()?(isNaN(base.options.fixedOffset)?base.options.fixedOffset.outerHeight():base.options.fixedOffset):base.$scrollableArea.offset().top+(!isNaN(base.options.fixedOffset)?base.options.fixedOffset:0),offset=$this.offset(),scrollTop=base.$scrollableArea.scrollTop()+ newTopOffset,scrollLeft=base.$scrollableArea.scrollLeft(),scrolledPastTop=base.isWindowScrolling()?scrollTop>offset.top:newTopOffset>offset.top,notScrolledPastBottom=(base.isWindowScrolling()?scrollTop:0)<(offset.top+ $this.height()- base.$clonedHeader.height()-(base.isWindowScrolling()?0:newTopOffset));if(scrolledPastTop&&notScrolledPastBottom){newLeft=offset.left- scrollLeft+ base.options.leftOffset;base.$originalHeader.css({'position':'fixed','margin-top':0,'left':newLeft,'z-index':1});base.isSticky=true;base.leftOffset=newLeft;base.topOffset=newTopOffset;base.$clonedHeader.css('display','');base.setPositionValues();base.updateWidth();}else if(base.isSticky){base.$originalHeader.css('position','static');base.$clonedHeader.css('display','none');base.isSticky=false;base.resetWidth($("td,th",base.$clonedHeader),$("td,th",base.$originalHeader));}});}};base.isWindowScrolling=function(){return base.$scrollableArea[0]===window;};base.setPositionValues=function(){var winScrollTop=Math.abs(base.$scrollableArea.scrollTop()),winScrollLeft=$(window).scrollLeft();var table=base.$originalHeader.closest('table');var t=-1*table.closest('article section').offset().top;var firefox=navigator.userAgent.toLowerCase().indexOf('firefox')>-1;var ie11=navigator.userAgent.toLowerCase().indexOf('trident')>-1;if(firefox||ie11)t=0;base.$originalHeader.css({'top':t+ jQuery('header').height()+1,'left':'auto'});};base.updateWidth=function(){if(!base.isSticky){return;}
if(!base.$originalHeaderCells){base.$originalHeaderCells=$('th,td',base.$originalHeader);}
if(!base.$clonedHeaderCells){base.$clonedHeaderCells=$('th,td',base.$clonedHeader);}
var cellWidths=base.getWidth(base.$clonedHeaderCells);base.setWidth(cellWidths,base.$clonedHeaderCells,base.$originalHeaderCells);base.$originalHeader.css('width',base.$clonedHeader.width());};base.getWidth=function($clonedHeaders){var widths=[];$clonedHeaders.each(function(index){var width,$this=$(this);if($this.css('box-sizing')==='border-box'){width=$this.outerWidth();}else{width=$this.width();}
widths[index]=width;});return widths;};base.setWidth=function(widths,$clonedHeaders,$origHeaders){$clonedHeaders.each(function(index){var width=widths[index];$origHeaders.eq(index).css({'min-width':width,'max-width':width});});};base.resetWidth=function($clonedHeaders,$origHeaders){$clonedHeaders.each(function(index){var $this=$(this);$origHeaders.eq(index).css({'min-width':$this.css("min-width"),'max-width':$this.css("max-width")});});};base.updateOptions=function(options){base.options=$.extend({},defaults,options);base.updateWidth();base.toggleHeaders();};base.init();}
$.fn[name]=function(options){return this.each(function(){var instance=$.data(this,'plugin_'+ name);if(instance){if(typeof options==="string"){instance[options].apply(instance);}else{instance.updateOptions(options);}}else if(options!=='destroy'){$.data(this,'plugin_'+ name,new Plugin(this,options));}});};})(jQuery,window);